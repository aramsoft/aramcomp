<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="aramframework.com.ssi.syi.iis.service.impl.CntcInsttMapper">

	<!--  Institute -->
    <select id="selectCntcInsttList" resultType="cntcInsttVO">
		<![CDATA[
            SELECT *
              FROM (
            SELECT ROWNUM RNUM, ALL_LIST.*
              FROM (
        ]]>
        /* 구현 Sql */
        <![CDATA[
            SELECT INSTT_ID        			AS "insttId"
                 , INSTT_NM        			AS "insttNm"
              FROM COMTN_CNTC_INSTT
             WHERE USE_AT = 'Y'
        ]]>
     	<if test='searchKeyword != null and searchKeyword != ""'>
        <choose>
            <when test='searchCondition == "INSTT_NM"'>
                 <![CDATA[ AND INSTT_NM LIKE '%'|| #{searchKeyword} ||'%' ]]>
            </when>
            <when test='searchCondition == "CodeList"'>
                 <![CDATA[ AND 1 = 1 ]]>
            </when>
        </choose>
		</if>
        /* 구현 Sql */
        <![CDATA[
                   ) ALL_LIST
                   )
             WHERE RNUM BETWEEN #{firstIndex} + 1 AND #{firstIndex} + #{recordPerPage}
        ]]>			
    </select>

    <select id="selectCntcInsttListCnt" resultType="int">
        <![CDATA[
            SELECT COUNT(*) totcnt
              FROM COMTN_CNTC_INSTT
             WHERE USE_AT = 'Y'
        ]]>
     	<if test='searchKeyword != null and searchKeyword != ""'>
        <choose>
            <when test='searchCondition == "INSTT_NM"'>
                 <![CDATA[ AND INSTT_NM LIKE '%'|| #{searchKeyword} ||'%' ]]>
            </when>
            <when test='searchCondition == "CodeList"'>
                 <![CDATA[ AND 1 = 1 ]]>
            </when>
        </choose>
		</if>
    </select>

    <select id="selectCntcInsttDetail" resultType="cntcInsttVO">
        <![CDATA[
            SELECT INSTT_ID        			AS "insttId"
                 , INSTT_NM        			AS "insttNm"
              FROM COMTN_CNTC_INSTT
             WHERE INSTT_ID = #{insttId}
               AND USE_AT = 'Y'
        ]]>
    </select>

    <insert id="insertCntcInstt">
        <![CDATA[
            INSERT INTO  COMTN_CNTC_INSTT (  
            	   INSTT_ID
                 , INSTT_NM
                 , USE_AT
				 , FRST_REGISTER_ID 
				 , FRST_REGIST_PNTTM 
				 , LAST_UPDUSR_ID
				 , LAST_UPDT_PNTTM 
            ) VALUES (  
            	   #{insttId}
                 , #{insttNm}
                 , 'Y'
				 , #{frstRegisterId}
				 , SYSDATE
				 , #{frstRegisterId} 
				 , SYSDATE
            )
        ]]>
    </insert>

    <update id="updateCntcInstt">
        <![CDATA[
            UPDATE COMTN_CNTC_INSTT
               SET INSTT_NM           = #{insttNm}
                 , LAST_UPDUSR_ID     = #{lastUpdusrId}
                 , LAST_UPDT_PNTTM    = SYSDATE
             WHERE INSTT_ID           = #{insttId}
        ]]>
    </update>

    <delete id="deleteCntcInstt">
        <![CDATA[
            UPDATE COMTN_CNTC_INSTT
               SET USE_AT             = 'N'
                 , LAST_UPDUSR_ID     = #{lastUpdusrId}
                 , LAST_UPDT_PNTTM    = SYSDATE
             WHERE INSTT_ID           = #{insttId}
        ]]>
    </delete>

	<!--  System -->
    <select id="selectCntcSystemList" resultType="cntcSystemVO">
		<![CDATA[
            SELECT *
              FROM (
            SELECT ROWNUM RNUM, ALL_LIST.*
              FROM (
        ]]>
        /* 구현 Sql */
        <![CDATA[
            SELECT INSTT_ID					AS "insttId"
                 , SYS_ID					AS "sysId"
                 , SYS_NM					AS "sysNm"
                 , SYS_IP					AS "sysIp"
              FROM COMTN_CNTC_SYSTEM
             WHERE USE_AT = 'Y'
        ]]>
     	<if test='searchKeyword != null and searchKeyword != ""'>
        <choose>
            <when test='searchCondition == "CodeList"'>
                 <![CDATA[ AND INSTT_ID = #{insttId}  ]]>
            </when>
        </choose>
		</if>
        /* 구현 Sql */
        <![CDATA[
                   ) ALL_LIST
                   )
             WHERE RNUM BETWEEN #{firstIndex} + 1 AND #{firstIndex} + #{recordPerPage}
        ]]>			
    </select>

    <select id="selectCntcSystemListCnt" resultType="int">
        <![CDATA[
            SELECT COUNT(*) totcnt
              FROM COMTN_CNTC_SYSTEM
             WHERE USE_AT = 'Y'
        ]]>
     	<if test='searchKeyword != null and searchKeyword != ""'>
        <choose>
            <when test='searchCondition == "CodeList"'>
                 <![CDATA[ AND INSTT_ID = #{insttId}  ]]>
            </when>
        </choose>
		</if>
    </select>

    <select id="selectCntcSystemDetail" resultType="cntcSystemVO">
        <![CDATA[
            SELECT INSTT_ID					AS "insttId"
                 , SYS_ID					AS "sysId"
                 , SYS_NM					AS "sysNm"
                 , SYS_IP					AS "sysIp"
              FROM COMTN_CNTC_SYSTEM
             WHERE INSTT_ID = #{insttId}
               AND SYS_ID   = #{sysId}
               AND USE_AT = 'Y'
        ]]>
    </select>

    <insert id="insertCntcSystem">
        <![CDATA[
            INSERT INTO  COMTN_CNTC_SYSTEM (  
            	   INSTT_ID
                 , SYS_ID
                 , SYS_NM
                 , SYS_IP
                 , USE_AT
				 , FRST_REGISTER_ID 
				 , FRST_REGIST_PNTTM 
				 , LAST_UPDUSR_ID
				 , LAST_UPDT_PNTTM 
            ) VALUES (  
            	   #{insttId}
                 , #{sysId}
                 , #{sysNm}
                 , #{sysIp}
                 , 'Y'
				 , #{frstRegisterId}
				 , SYSDATE
				 , #{frstRegisterId} 
				 , SYSDATE
            )
        ]]>
    </insert>

    <update id="updateCntcSystem">
        <![CDATA[
            UPDATE COMTN_CNTC_SYSTEM
               SET SYS_NM             = #{sysNm}
                 , SYS_IP             = #{sysIp}
                 , LAST_UPDUSR_ID     = #{lastUpdusrId}
                 , LAST_UPDT_PNTTM    = SYSDATE
             WHERE INSTT_ID           = #{insttId}
               AND SYS_ID             = #{sysId}
        ]]>
    </update>

    <delete id="deleteCntcSystem">
        <![CDATA[
            UPDATE COMTN_CNTC_SYSTEM
               SET USE_AT             = 'N'
                 , LAST_UPDUSR_ID     = #{lastUpdusrId}
                 , LAST_UPDT_PNTTM    = SYSDATE
             WHERE INSTT_ID           = #{insttId}
               AND SYS_ID             = #{sysId}
        ]]>
    </delete>

	<!--  Service -->
    <select id="selectCntcServiceList" resultType="cntcServiceVO">
		<![CDATA[
            SELECT *
              FROM (
            SELECT ROWNUM RNUM, ALL_LIST.*
              FROM (
        ]]>
        /* 구현 Sql */
        <![CDATA[
            SELECT INSTT_ID					AS "insttId"
                 , SYS_ID					AS "sysId"
                 , SVC_ID					AS "svcId"
                 , SVC_NM					AS "svcNm"
                 , REQUST_MSSAGE_ID 		AS "requestMessageId"
                 , RSPNS_MSSAGE_ID   		AS "rspnsMessageId"
              FROM COMTN_CNTC_SERVICE
             WHERE USE_AT = 'Y'
        ]]>
     	<if test='searchKeyword != null and searchKeyword != ""'>
        <choose>
            <when test='searchCondition == "CodeList"'>
        		<![CDATA[
                 	AND INSTT_ID = #{insttId}
                 	AND SYS_ID = #{sysId}
         		]]>
            </when>
            <when test='searchCondition == "CodeList_InsttId"'>
                 <![CDATA[ AND INSTT_ID = #{insttId} ]]>
            </when>
        </choose>
		</if>
        /* 구현 Sql */
        <![CDATA[
                   ) ALL_LIST
                   )
             WHERE RNUM BETWEEN #{firstIndex} + 1 AND #{firstIndex} + #{recordPerPage}
        ]]>			
    </select>

    <select id="selectCntcServiceListCnt" resultType="int">
        <![CDATA[
            SELECT COUNT(*) totcnt
              FROM COMTN_CNTC_SYSTEM
             WHERE USE_AT = 'Y'
        ]]>
     	<if test='searchKeyword != null and searchKeyword != ""'>
        <choose>
            <when test='searchCondition == "CodeList"'>
        		<![CDATA[
                 	AND INSTT_ID = #{insttId}
                 	AND SYS_ID = #{sysId}
         		]]>
            </when>
            <when test='searchCondition == "CodeList_InsttId"'>
                 <![CDATA[ AND INSTT_ID = #{insttId} ]]>
            </when>
        </choose>
		</if>
    </select>

    <select id="selectCntcServiceDetail" resultType="cntcServiceVO">
        <![CDATA[
            SELECT INSTT_ID					AS "insttId"
                 , SYS_ID					AS "sysId"
                 , SVC_ID					AS "svcId"
                 , SVC_NM					AS "svcNm"
                 , REQUST_MSSAGE_ID 		AS "requestMessageId"
                 , RSPNS_MSSAGE_ID   		AS "rspnsMessageId"
              FROM COMTN_CNTC_SERVICE
             WHERE INSTT_ID = #{insttId}
               AND SYS_ID   = #{sysId}
               AND SVC_ID   = #{svcId}
               AND USE_AT = 'Y'
        ]]>
    </select>

    <insert id="insertCntcService">
        <![CDATA[
            INSERT INTO  COMTN_CNTC_SERVICE (  
            	   INSTT_ID
                 , SYS_ID
                 , SVC_ID
                 , SVC_NM
                 , REQUST_MSSAGE_ID
                 , RSPNS_MSSAGE_ID
                 , USE_AT
				 , FRST_REGISTER_ID 
				 , FRST_REGIST_PNTTM 
				 , LAST_UPDUSR_ID
				 , LAST_UPDT_PNTTM 
            ) VALUES (  
            	   #{insttId}
                 , #{sysId}
                 , #{svcId}
                 , #{svcNm}
                 , #{requestMessageId}
                 , #{rspnsMessageId}
                 , 'Y'
				 , #{frstRegisterId}
				 , SYSDATE
				 , #{frstRegisterId} 
				 , SYSDATE
            )
        ]]>
    </insert>

    <update id="updateCntcService">
        <![CDATA[
            UPDATE COMTN_CNTC_SERVICE
               SET SVC_NM             = #{svcNm}
                 , REQUST_MSSAGE_ID   = #{requestMessageId}
                 , RSPNS_MSSAGE_ID    = #{rspnsMessageId}
                 , LAST_UPDUSR_ID     = #{lastUpdusrId}
                 , LAST_UPDT_PNTTM    = SYSDATE
             WHERE INSTT_ID           = #{insttId}
               AND SYS_ID             = #{sysId}
               AND SVC_ID             = #{svcId}
        ]]>
    </update>

    <delete id="deleteCntcService">
        <![CDATA[
            UPDATE COMTN_CNTC_SERVICE
               SET USE_AT             = 'N'
                 , LAST_UPDUSR_ID     = #{lastUpdusrId}
                 , LAST_UPDT_PNTTM    = SYSDATE
             WHERE INSTT_ID           = #{insttId}
               AND SYS_ID             = #{sysId}
               AND SVC_ID             = #{svcId}
        ]]>
    </delete>

</mapper>