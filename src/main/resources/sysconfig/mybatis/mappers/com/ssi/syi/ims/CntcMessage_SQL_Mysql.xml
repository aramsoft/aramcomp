<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="aramframework.com.ssi.syi.ims.service.CntcMessageMapper">

    <select id="selectCntcMessageList" resultType="cntcMessageVO">
        /* 구현 Sql */
        <![CDATA[
            SELECT CNTC_MSSAGE_ID      		AS "cntcMessageId"
                 , CNTC_MSSAGE_NM      		AS "cntcMessageNm"
                 , UPPER_CNTC_MSSAGE_ID  	AS "upperCntcMessageId"
              FROM COMTN_CNTC_MESSAGE
             WHERE USE_AT = 'Y'
        ]]>
     	<if test='searchKeyword != null and searchKeyword != ""'>
        <choose>
            <when test='searchCondition == "CNTC_MSSAGE_NM"'>
                 <![CDATA[ AND CNTC_MSSAGE_NM LIKE '%'|| #{searchKeyword} ||'%' ]]>
            </when>
            <when test='searchCondition == "CodeList"'>
                 <![CDATA[ AND 1 = 1 ]]>
            </when>
        </choose>
		</if>
         /* 구현 Sql */
        <![CDATA[
 			LIMIT  #{recordPerPage} OFFSET #{firstIndex}
        ]]>			
    </select>

    <select id="selectCntcMessageListCnt" resultType="int">
        <![CDATA[
            SELECT COUNT(*) totcnt
              FROM COMTN_CNTC_MESSAGE
             WHERE USE_AT = 'Y'
        ]]>
     	<if test='searchKeyword != null and searchKeyword != ""'>
        <choose>
            <when test='searchCondition == "CNTC_MSSAGE_NM"'>
                 <![CDATA[ AND CNTC_MSSAGE_NM LIKE '%'|| #{searchKeyword} ||'%' ]]>
            </when>
            <when test='searchCondition == "CodeList"'>
                 <![CDATA[ AND 1 = 1 ]]>
            </when>
        </choose>
		</if>
    </select>

    <select id="selectCntcMessageDetail" resultType="cntcMessageVO">
        <![CDATA[
            SELECT CNTC_MSSAGE_ID      		AS "cntcMessageId"
                 , CNTC_MSSAGE_NM      		AS "cntcMessageNm"
                 , UPPER_CNTC_MSSAGE_ID  	AS "upperCntcMessageId"
              FROM COMTN_CNTC_MESSAGE
             WHERE CNTC_MSSAGE_ID = #{cntcMessageId}
               AND USE_AT          = 'Y'
        ]]>
    </select>

    <insert id="insertCntcMessage">
        <![CDATA[
            INSERT INTO  COMTN_CNTC_MESSAGE (  
            	   CNTC_MSSAGE_ID
                 , CNTC_MSSAGE_NM
                 , UPPER_CNTC_MSSAGE_ID
                 , USE_AT
				 , FRST_REGISTER_ID 
				 , FRST_REGIST_PNTTM 
				 , LAST_UPDUSR_ID
				 , LAST_UPDT_PNTTM 
            ) VALUES (  
            	   #{cntcMessageId}
                 , #{cntcMessageNm}
                 , #{upperCntcMessageId}
                 , 'Y'
				 , #{frstRegisterId}
				 , sysdate()
				 , #{frstRegisterId} 
				 , sysdate()
            )
        ]]>
    </insert>

    <update id="updateCntcMessage">
        <![CDATA[
            UPDATE COMTN_CNTC_MESSAGE
               SET CNTC_MSSAGE_NM       = #{cntcMessageNm}
                 , UPPER_CNTC_MSSAGE_ID = #{upperCntcMessageId}
                 , LAST_UPDUSR_ID       = #{lastUpdusrId}
                 , LAST_UPDT_PNTTM      = sysdate()
             WHERE CNTC_MSSAGE_ID       = #{cntcMessageId}
        ]]>
    </update>

    <delete id="deleteCntcMessage">
        <![CDATA[
            UPDATE COMTN_CNTC_MESSAGE
               SET USE_AT            = 'N'
                 , LAST_UPDUSR_ID    = #{lastUpdusrId}
                 , LAST_UPDT_PNTTM   = sysdate()
             WHERE CNTC_MSSAGE_ID    = #{cntcMessageId}
        ]]>
    </delete>

    <select id="selectCntcMessageItemList" resultType="egovMap">
        /* 구현 Sql */
        <![CDATA[
            SELECT CNTC_MSSAGE_ID			CNTC_MESSAGE_ID
                 , IEM_ID					ITEM_ID
                 , IEM_NM					ITEM_NM
                 , IEM_TY					ITEM_TYPE
                 , IEM_LT					ITEM_LT
              FROM COMTN_CNTC_MESSAGE_ITEM
             WHERE USE_AT = 'Y'
        ]]>
     	<if test='searchKeyword != null and searchKeyword != ""'>
        <choose>
            <when test='searchCondition == "CodeList"'>
                 <![CDATA[ AND CNTC_MSSAGE_ID = #{cntcMessageId} ]]>
            </when>
        </choose>
		</if>
        /* 구현 Sql */
        <![CDATA[
 			LIMIT  #{recordPerPage} OFFSET #{firstIndex}
        ]]>			
    </select>

    <select id="selectCntcMessageItemListCnt" resultType="int">
        <![CDATA[
            SELECT COUNT(*) totcnt
              FROM COMTN_CNTC_MESSAGE_ITEM
             WHERE USE_AT = 'Y'
        ]]>
     	<if test='searchKeyword != null and searchKeyword != ""'>
        <choose>
            <when test='searchCondition == "CodeList"'>
                 <![CDATA[ AND CNTC_MSSAGE_ID = #{cntcMessageId} ]]>
            </when>
        </choose>
		</if>
    </select>

    <select id="selectCntcMessageItemDetail" resultType="cntcMessageItemVO">
        <![CDATA[
            SELECT CNTC_MSSAGE_ID  			AS "cntcMessageId"
                 , IEM_ID          			AS "itemId"
                 , IEM_NM          			AS "itemNm"
                 , IEM_TY        			AS "itemType"
                 , IEM_LT          			AS "itemLt"
              FROM COMTN_CNTC_MESSAGE_ITEM
             WHERE CNTC_MSSAGE_ID = #{cntcMessageId}
               AND IEM_ID         = #{itemId}
               AND USE_AT          = 'Y'
        ]]>
    </select>

    <insert id="insertCntcMessageItem">
        <![CDATA[
            INSERT INTO  COMTN_CNTC_MESSAGE_ITEM (  
            	   CNTC_MSSAGE_ID
                 , IEM_ID
                 , IEM_NM
                 , IEM_TY
                 , IEM_LT
                 , USE_AT
				 , FRST_REGISTER_ID 
				 , FRST_REGIST_PNTTM 
				 , LAST_UPDUSR_ID
				 , LAST_UPDT_PNTTM 
            ) VALUES (  
            	   #{cntcMessageId}
                 , #{itemId}
                 , #{itemNm}
                 , #{itemType}
                 , #{itemLt}
                 , 'Y'
				 , #{frstRegisterId}
				 , sysdate()
				 , #{frstRegisterId} 
				 , sysdate()
            )
        ]]>
    </insert>

    <update id="updateCntcMessageItem">
        <![CDATA[
            UPDATE COMTN_CNTC_MESSAGE_ITEM
               SET IEM_NM           = #{itemNm}
                 , IEM_TY           = #{itemType}
                 , IEM_LT           = #{itemLt}
                 , LAST_UPDUSR_ID   = #{lastUpdusrId}
                 , LAST_UPDT_PNTTM  = sysdate()
             WHERE CNTC_MSSAGE_ID   = #{cntcMessageId}
               AND IEM_ID           = #{itemId}
        ]]>
    </update>

    <delete id="deleteCntcMessageItem">
        <![CDATA[
            UPDATE COMTN_CNTC_MESSAGE_ITEM
               SET USE_AT            = 'N'
                 , LAST_UPDUSR_ID    = #{lastUpdusrId}
                 , LAST_UPDT_PNTTM   = sysdate()
             WHERE CNTC_MSSAGE_ID    = #{cntcMessageId}
               AND IEM_ID            = #{itemId}
        ]]>
    </delete>

</mapper>