<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="aramframework.com.sym.ccm.adc.dao.AdministCodeManageMapper">

	<!-- 목록조회  -->
	<select id="selectAdministCodeList" resultType="egovMap">
		<![CDATA[
            SELECT *
              FROM (
            SELECT ROWNUM RNUM, ALL_LIST.*
              FROM (
        ]]>
        /* 구현 Sql */
		<![CDATA[
			SELECT ADMINIST_ZONE_SE			AS "administZoneSe"
			     , ADMINIST_ZONE_CODE		AS "administZoneCode"
			     , ADMINIST_ZONE_NM			AS "administZoneNm"
			     , USE_AT					AS "useAt"
			  FROM COMTC_ADMINIST_CODE
			 WHERE 1 = 1
		]]>
      	<if test='searchKeyword != null and searchKeyword != ""'>
				<![CDATA[ AND ADMINIST_ZONE_SE = #{searchCondition}]]>
				<![CDATA[ AND ADMINIST_ZONE_NM LIKE '%'||#{searchKeyword}||'%']]>
		</if>
       	/* 구현 Sql */
        <![CDATA[
                   ) ALL_LIST
                   )
             WHERE RNUM BETWEEN #{firstIndex} + 1 AND #{firstIndex} + #{recordPerPage}
        ]]>			
	</select>

	<!-- 목록조회_게시물 총갯수  -->
	<select id="selectAdministCodeListCnt" resultType="int">
		<![CDATA[
			SELECT COUNT(*) totcnt
			  FROM COMTC_ADMINIST_CODE
			 WHERE 1 = 1
		]]>
      	<if test='searchKeyword != null and searchKeyword != ""'>
				<![CDATA[ AND ADMINIST_ZONE_SE = #{searchCondition}]]>
				<![CDATA[ AND ADMINIST_ZONE_NM LIKE '%'||#{searchKeyword}||'%']]>
		</if>
	</select>

	<!-- 상세보기 -->
	<select id="selectAdministCodeDetail" resultType="administCodeVO">
		<![CDATA[
			SELECT ADMINIST_ZONE_SE         AS "administZoneSe"
			     , ADMINIST_ZONE_CODE       AS "administZoneCode"
			     , ADMINIST_ZONE_NM       	AS "administZoneNm"
			     , UPPER_ADMINIST_ZONE_CODE AS "upperAdministZoneCode"
			     , (
			        SELECT X.ADMINIST_ZONE_NM
			          FROM COMTC_ADMINIST_CODE X
			         WHERE X.ADMINIST_ZONE_SE   = A.ADMINIST_ZONE_SE
			           AND X.ADMINIST_ZONE_CODE = A.UPPER_ADMINIST_ZONE_CODE
			       )                        AS "upperAdministZoneNm"
			     , CREAT_DE                 AS "creatDe"
			     , ABL_DE                   AS "ablDe"
			     , USE_AT                   AS "useAt"
			  FROM COMTC_ADMINIST_CODE A
             WHERE ADMINIST_ZONE_SE   = #{administZoneSe}
               AND ADMINIST_ZONE_CODE = #{administZoneCode}
		]]>
	</select>

	<!-- 입력 -->
	<insert id="insertAdministCode">
		<![CDATA[
			INSERT INTO  COMTC_ADMINIST_CODE (  
				   ADMINIST_ZONE_SE
			     , ADMINIST_ZONE_CODE
			     , ADMINIST_ZONE_NM
			     , UPPER_ADMINIST_ZONE_CODE
			     , CREAT_DE
			     , ABL_DE
			     , USE_AT
				 , FRST_REGISTER_ID 
				 , FRST_REGIST_PNTTM 
				 , LAST_UPDUSR_ID
				 , LAST_UPDT_PNTTM 
			) VALUES (  
				   #{administZoneSe}
			     , #{administZoneCode}
			     , #{administZoneNm}
			     , #{upperAdministZoneCode}
			     , #{creatDe}
			     , #{ablDe}
			     , #{useAt}
				 , #{frstRegisterId}
				 , SYSDATE
				 , #{frstRegisterId} 
				 , SYSDATE
			)
		]]>
	</insert>

	<!-- 수정 -->
	<update id="updateAdministCode">
		<![CDATA[
            UPDATE COMTC_ADMINIST_CODE
               SET ADMINIST_ZONE_NM         = #{administZoneNm}
			     , UPPER_ADMINIST_ZONE_CODE = #{upperAdministZoneCode}
			     , CREAT_DE                 = #{creatDe}
			     , ABL_DE                   = #{ablDe}
			     , USE_AT                   = #{useAt}
                 , LAST_UPDUSR_ID           = #{lastUpdusrId}
                 , LAST_UPDT_PNTTM        	= SYSDATE
             WHERE ADMINIST_ZONE_SE   = #{administZoneSe}
               AND ADMINIST_ZONE_CODE = #{administZoneCode}
		]]>
	</update>

	<!-- 삭제 -->
	<delete id="deleteAdministCode">
		<![CDATA[
            UPDATE COMTC_ADMINIST_CODE
               SET ABL_DE             = TO_CHAR(SYSDATE,'YYYYMMDD')
			     , USE_AT             = 'N'
             WHERE ADMINIST_ZONE_SE   = #{administZoneSe}
               AND ADMINIST_ZONE_CODE = #{administZoneCode}
		]]>
	</delete>

</mapper>