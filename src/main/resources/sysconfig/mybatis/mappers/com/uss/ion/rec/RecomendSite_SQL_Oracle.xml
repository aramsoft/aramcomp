<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="aramframework.com.uss.ion.rec.service.impl.RecomendSiteMapper">

	<select id="selectRecomendSiteList" resultType="egovMap">
		<![CDATA[
            SELECT *
              FROM (
            SELECT ROWNUM RNUM, ALL_LIST.*
              FROM (
        ]]>
        /* 구현 Sql */
		<![CDATA[
      		SELECT RECOMEND_SITE_ID			AS "recomendSiteId"
      			 , RECOMEND_SITE_URL		AS "recomendSiteUrl"
      			 , RECOMEND_SITE_NM			AS "recomendSiteNm"
      			 , RECOMEND_CONFM_AT		AS "recomendConfmAt"
			     , CONFM_DE					AS "confmDe"
 			     , FRST_REGIST_PNTTM		AS "frstRegisterPnttm"   
		      FROM COMTN_RECOMEND_SITE_INFO
		     WHERE 1=1
		]]>
   	    <if test='trgetId != null and trgetId != ""'>
		   		<![CDATA[AND TRGET_ID = #{trgetId} ]]>
		</if>
   	    <if test='searchKeyword != null and searchKeyword != ""'>
        <choose>
            <when test='searchCondition == "RECOMEND_SITE_NM"'>
                <![CDATA[ AND RECOMEND_SITE_NM LIKE '%'|| #{searchKeyword} ||'%' ]]>
            </when>
            <when test='searchCondition == "RECOMEND_SITE_URL"'>
                <![CDATA[ AND RECOMEND_SITE_URL LIKE '%'|| #{searchKeyword} ||'%' ]]>
            </when>
        </choose>
		</if>
		<![CDATA[
		     ORDER BY FRST_REGIST_PNTTM DESC
		]]>				
        /* 구현 Sql */
        <![CDATA[
                   ) ALL_LIST
                   )
             WHERE RNUM BETWEEN #{firstIndex} + 1 AND #{firstIndex} + #{recordPerPage}
        ]]>			
	</select>

	<select id="selectRecomendSiteListCnt" resultType="int">
		<![CDATA[
			SELECT COUNT(*) totcnt
			  FROM COMTN_RECOMEND_SITE_INFO
			 WHERE 1=1
		]]>
   	    <if test='trgetId != null and trgetId != ""'>
		   		<![CDATA[AND TRGET_ID = #{trgetId} ]]>
		</if>
   	    <if test='searchKeyword != null and searchKeyword != ""'>
        <choose>
            <when test='searchCondition == "RECOMEND_SITE_NM"'>
                <![CDATA[ AND RECOMEND_SITE_NM LIKE '%'|| #{searchKeyword} ||'%' ]]>
            </when>
            <when test='searchCondition == "RECOMEND_SITE_URL"'>
                <![CDATA[ AND RECOMEND_SITE_URL LIKE '%'|| #{searchKeyword} ||'%' ]]>
            </when>
        </choose>
		</if>
	</select>

	<select id="selectRecomendSiteDetail" resultType="recomendSiteVO">
		<![CDATA[
			SELECT RECOMEND_SITE_ID
			     , RECOMEND_SITE_URL
			     , RECOMEND_SITE_NM
			     , RECOMEND_SITE_DC
			     , RECOMEND_RESN_CN
			     , RECOMEND_CONFM_AT
			     , CONFM_DE
			     , FRST_REGIST_PNTTM 	AS "frstRegisterPnttm"
			     , FRST_REGISTER_ID
			     , LAST_UPDT_PNTTM 		AS "lastUpdusrPnttm"
			     , LAST_UPDUSR_ID
			  FROM COMTN_RECOMEND_SITE_INFO
			 WHERE RECOMEND_SITE_ID = #{recomendSiteId}
		]]>
	</select>

	<insert id="insertRecomendSiteInfo">
		<![CDATA[
			INSERT INTO COMTN_RECOMEND_SITE_INFO (
					RECOMEND_SITE_ID
				  ,	RECOMEND_SITE_URL
				  ,	RECOMEND_SITE_NM
				  ,	RECOMEND_SITE_DC
			  	  ,	RECOMEND_RESN_CN
				  ,	RECOMEND_CONFM_AT
				  ,	CONFM_DE
				  , FRST_REGISTER_ID 
				  , FRST_REGIST_PNTTM 
				  , LAST_UPDUSR_ID
				  , LAST_UPDT_PNTTM 
			  	  ,	TRGET_ID
			) VALUES ( 
					#{recomendSiteId}
				  , #{recomendSiteUrl}
				  , #{recomendSiteNm}
				  , #{recomendSiteDc}
				  , #{recomendResnCn}
				  , #{recomendConfmAt}
				  , #{confmDe}
				  , #{frstRegisterId}
				  , SYSDATE
				  , #{frstRegisterId}
				  , SYSDATE
			  	  ,	#{trgetId}
			)
		]]>
	</insert>

	<update id="updateRecomendSiteInfo">
		<![CDATA[
			UPDATE COMTN_RECOMEND_SITE_INFO	
			   SET RECOMEND_SITE_ID		= #{recomendSiteId}
				 , RECOMEND_SITE_URL	= #{recomendSiteUrl}
				 , RECOMEND_SITE_NM		= #{recomendSiteNm}
				 , RECOMEND_SITE_DC		= #{recomendSiteDc}
			  	 , RECOMEND_RESN_CN		= #{recomendResnCn}
				 , RECOMEND_CONFM_AT	= #{recomendConfmAt}
				 , CONFM_DE				= #{confmDe}
				 , LAST_UPDUSR_ID		= #{lastUpdusrId}
 				 , LAST_UPDT_PNTTM		=SYSDATE
			 WHERE RECOMEND_SITE_ID = #{recomendSiteId}
		]]>
	</update>

	<delete id="deleteRecomendSiteInfo">
		<![CDATA[
			DELETE 
			  FROM COMTN_RECOMEND_SITE_INFO
			 WHERE RECOMEND_SITE_ID = #{recomendSiteId}
		]]>
	</delete>

</mapper>
