<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="aramframework.com.uss.ion.ulm.service.UnityLinkMapper">

	<!-- 통합링크:: 메인 셈플 목록 -->
	<select id="selectUnityLinkSample" resultType="egovMap">
       	<![CDATA[
			SELECT A.UNITY_LINK_ID			AS "unityLinkId"
			     , A.UNITY_LINK_NM			AS "unityLinkNm"
			     , A.UNITY_LINK_URL			AS "unityLinkUrl"
			  FROM COMTN_UNITY_LINK A
			 ORDER BY A.FRST_REGIST_PNTTM DESC
		 ]]>
	</select>

	<!-- 통합링크::목록조회 게시물정보 -->
	<select id="selectUnityLinkList" resultType="egovMap">
        /* 구현 Sql */
       	<![CDATA[
			SELECT A.UNITY_LINK_ID			AS "unityLinkId"
			     , A.UNITY_LINK_SE_CODE		AS "unityLinkSeCode"
			     , A.UNITY_LINK_NM			AS "unityLinkNm"
			     , A.UNITY_LINK_URL			AS "unityLinkUrl"
			     , A.FRST_REGIST_PNTTM		AS "frstRegisterPnttm" 
			     , (SELECT USER_NM 
			          FROM COMTN_EMPLYR_INFO 
			         WHERE ESNTL_ID = A.FRST_REGISTER_ID
			       ) 						AS "frstRegisterNm" 
			  FROM COMTN_UNITY_LINK A
			 WHERE 1=1
		]]>
  	    <if test='searchKeyword != null and searchKeyword != ""'>
        <choose>
            <when test='searchCondition == "UNITY_LINK_NM"'>
                <![CDATA[ AND UNITY_LINK_NM LIKE '%'|| #{searchKeyword} ||'%' ]]>
            </when>
            <when test='searchCondition == "UNITY_LINK_DC"'>
                <![CDATA[ AND UNITY_LINK_DC LIKE '%'|| #{searchKeyword} ||'%' ]]>
            </when>
        </choose>
		</if>
		<![CDATA[
			 ORDER BY A.FRST_REGIST_PNTTM DESC
		]]>				
        /* 구현 Sql */
        <![CDATA[
 			LIMIT  #{recordPerPage} OFFSET #{firstIndex}
        ]]>			
	</select>
	<!-- 통합링크::목록조회_게시물 총갯수  -->
	<select id="selectUnityLinkListCnt" resultType="int">
		<![CDATA[
			SELECT COUNT(*) totcnt
			  FROM COMTN_UNITY_LINK
			 WHERE 1=1
        ]]>			
  	    <if test='searchKeyword != null and searchKeyword != ""'>
        <choose>
            <when test='searchCondition == "UNITY_LINK_NM"'>
                <![CDATA[ AND UNITY_LINK_NM LIKE '%'|| #{searchKeyword} ||'%' ]]>
            </when>
            <when test='searchCondition == "UNITY_LINK_DC"'>
                <![CDATA[ AND UNITY_LINK_DC LIKE '%'|| #{searchKeyword} ||'%' ]]>
            </when>
        </choose>
		</if>
	</select>

	<!-- 통합링크::상세보기 -->
	<select id="selectUnityLinkDetail" resultType="unityLinkVO">
		<![CDATA[
			SELECT A.UNITY_LINK_ID
			     , A.UNITY_LINK_SE_CODE
			     , A.UNITY_LINK_NM
			     , A.UNITY_LINK_URL
			     , A.UNITY_LINK_DC
			     , A.FRST_REGIST_PNTTM		AS "frstRegisterPnttm"
			     , A.FRST_REGISTER_ID
			     , A.LAST_UPDT_PNTTM		AS "lastUpdusrPnttm"
			     , A.LAST_UPDUSR_ID
			  FROM COMTN_UNITY_LINK A
			 WHERE A.UNITY_LINK_ID = #{unityLinkId}
        ]]>			
	</select>

	<!-- 통합링크::입력  -->
	<insert id="insertUnityLink">
	 	<![CDATA[
			INSERT INTO COMTN_UNITY_LINK (
					UNITY_LINK_ID
				  ,	UNITY_LINK_SE_CODE
				  ,	UNITY_LINK_NM
				  ,	UNITY_LINK_URL
				  ,	UNITY_LINK_DC
				  , FRST_REGISTER_ID 
				  , FRST_REGIST_PNTTM 
				  , LAST_UPDUSR_ID
				  , LAST_UPDT_PNTTM 
			)VALUES(
					#{unityLinkId}
				  ,	#{unityLinkSeCode}
				  , #{unityLinkNm}
				  , #{unityLinkUrl}
				  ,	#{unityLinkDc}
				  , #{frstRegisterId}
				  , sysdate()
				  , #{frstRegisterId}
				  , sysdate()
			)
	 	]]>
	</insert>

	<!-- 통합링크::수정  -->
	<update id="updateUnityLink">
		<![CDATA[
			UPDATE COMTN_UNITY_LINK
			   SET UNITY_LINK_SE_CODE 	= #{unityLinkSeCode}
			     , UNITY_LINK_NM 		= #{unityLinkNm}
			     , UNITY_LINK_URL 		= #{unityLinkUrl}
			     , UNITY_LINK_DC 		= #{unityLinkDc}
			     , LAST_UPDUSR_ID 		= #{lastUpdusrId}
			     , LAST_UPDT_PNTTM 		= sysdate()
			 WHERE UNITY_LINK_ID = #{unityLinkId}
		]]>
	</update>

    <!-- 통합링크::삭제  -->
	<delete id="deleteUnityLink">
		<![CDATA[
			DELETE 
			  FROM COMTN_UNITY_LINK
			 WHERE UNITY_LINK_ID = #{unityLinkId}
		]]>
	</delete>

</mapper>