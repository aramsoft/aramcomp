<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="aramframework.com.uss.olh.hpc.service.impl.HpcmManageMapper">

	<select id="selectHpcmList" resultType="egovMap">
        /* 구현 Sql */
       	<![CDATA[
			SELECT A.HPCM_ID				AS "hpcmId"	
				 , B.CODE_NM				AS "hpcmSeCodeNm"
				 , A.HPCM_DFN				AS "hpcmDfn"
 			     , A.FRST_REGIST_PNTTM		AS "frstRegisterPnttm"   
		      FROM COMTN_HPCM_INFO A
				   LEFT OUTER JOIN (SELECT CODE, CODE_NM
					    	   		  FROM COMTC_CMMN_DETAIL_CODE  	
					    	  		 WHERE CODE_ID = 'COM021') B
				       	ON A.HPCM_SE_CODE = B.CODE
		     WHERE 1=1
		]]>
  	    <if test='searchKeyword != null and searchKeyword != ""'>
        <choose>
            <when test='searchCondition == "HPCM_SE_CODE"'>
                <![CDATA[ AND B.CODE_NM LIKE '%'|| #{searchKeyword} ||'%' ]]>
            </when>
            <when test='searchCondition == "HPCM_DFN"'>
                <![CDATA[ AND A.HPCM_DFN LIKE '%'|| #{searchKeyword} ||'%' ]]>
            </when>
        </choose>
		</if>
		<![CDATA[
		     ORDER BY HPCM_ID DESC
		]]>				
        /* 구현 Sql */
        <![CDATA[
 			LIMIT  #{recordPerPage} OFFSET #{firstIndex}
        ]]>			
	</select>

	<select id="selectHpcmListCnt" resultType="int">
		<![CDATA[
			SELECT COUNT(*) totcnt
		      FROM COMTN_HPCM_INFO A
				   LEFT OUTER JOIN (SELECT CODE, CODE_NM
					    	   		  FROM COMTC_CMMN_DETAIL_CODE  	
					    	  		 WHERE CODE_ID = 'COM021') B
				       	ON A.HPCM_SE_CODE = B.CODE
		     WHERE 1=1
		]]>
  	    <if test='searchKeyword != null and searchKeyword != ""'>
        <choose>
            <when test='searchCondition == "HPCM_SE_CODE"'>
                <![CDATA[ AND B.CODE_NM LIKE '%'|| #{searchKeyword} ||'%' ]]>
            </when>
            <when test='searchCondition == "HPCM_DFN"'>
                <![CDATA[ AND A.HPCM_DFN LIKE '%'|| #{searchKeyword} ||'%' ]]>
            </when>
        </choose>
		</if>
	</select>

	<select id="selectHpcmDetail" resultType="hpcmManageVO">
		<![CDATA[
			SELECT A.HPCM_ID
			     , A.HPCM_SE_CODE
			     , B.CODE_NM 				AS "hpcmSeCodeNm"
			     , A.HPCM_DFN
			     , A.HPCM_DC
			     , A.FRST_REGIST_PNTTM 		AS "frstRegisterPnttm"   
			     , A.FRST_REGISTER_ID
			     , A.LAST_UPDT_PNTTM   		AS "lastUpdusrPnttm"	  
			     , A.LAST_UPDUSR_ID
			  FROM COMTN_HPCM_INFO	A
				   LEFT OUTER JOIN (SELECT CODE, CODE_NM
					    	   		  FROM COMTC_CMMN_DETAIL_CODE  	
					    	  		 WHERE CODE_ID = 'COM021') B
				       	ON A.HPCM_SE_CODE = B.CODE
			 WHERE A.HPCM_ID = #{hpcmId}
		]]>
	</select>

	<insert id="insertHpcmCn">
		<![CDATA[
			INSERT INTO COMTN_HPCM_INFO (
					HPCM_ID
				  , HPCM_SE_CODE
				  , HPCM_DFN
				  , HPCM_DC
				  , FRST_REGISTER_ID 
				  , FRST_REGIST_PNTTM 
				  , LAST_UPDUSR_ID
				  , LAST_UPDT_PNTTM 
			) VALUES ( 
					#{hpcmId}
				  , #{hpcmSeCode}
				  , #{hpcmDfn}
				  , #{hpcmDc}
				  , #{frstRegisterId}
				  , sysdate()
				  , #{frstRegisterId} 
				  , sysdate()
			)
		]]>
	</insert>

	<update id="updateHpcmCn">
		<![CDATA[
			UPDATE COMTN_HPCM_INFO	
			   SET HPCM_ID			= #{hpcmId}
				 , HPCM_SE_CODE		= #{hpcmSeCode}
				 , HPCM_DFN			= #{hpcmDfn}
				 , HPCM_DC			= #{hpcmDc}
				 , LAST_UPDUSR_ID	= #{lastUpdusrId}
				 , LAST_UPDT_PNTTM	= sysdate()
 			 WHERE HPCM_ID = #{hpcmId}
		]]>
	</update>

	<delete id="deleteHpcmCn">
		<![CDATA[
			DELETE 
			  FROM COMTN_HPCM_INFO
			 WHERE HPCM_ID = #{hpcmId}
		]]>
	</delete>

</mapper>
