<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="aramframework.com.uss.olh.omm.dao.OnlineManualMapper">

	<!-- 온라인메뉴얼::목록조회 게시물정보 -->
	<select id="selectOnlineManualList" resultType="egovMap">
        /* 구현 Sql */
       	<![CDATA[
		    SELECT A.ONLINE_MNL_ID			AS "onlineMnlId"
		         , A.ONLINE_MNL_NM			AS "onlineMnlNm"
		         , A.ONLINE_MNL_SE_CODE		AS "onlineMnlSeCode"
		         , A.FRST_REGIST_PNTTM		AS "frstRegisterPnttm" 
		         , (SELECT USER_NM 
		              FROM COMVN_USER_MASTER 
		             WHERE ESNTL_ID = A.FRST_REGISTER_ID
		           ) 						AS "frstRegisterNm" 
		      FROM COMTN_ONLINE_MANUAL A
		     WHERE 1=1
	 	]]>
	    <if test='searchVO.searchKeyword != null and searchVO.searchKeyword != ""'>
        <choose>
            <when test='searchVO.searchCondition == "ONLINE_MNL_NM"'>
                <![CDATA[ AND ONLINE_MNL_NM LIKE '%'|| #{searchVO.searchKeyword} ||'%' ]]>
            </when>
            <when test='searchVO.searchCondition == "ONLINE_MNL_DFN"'>
                <![CDATA[ AND ONLINE_MNL_DFN LIKE '%'|| #{searchVO.searchKeyword} ||'%' ]]>
            </when>
            <when test='searchVO.searchCondition == "ONLINE_MNL_DC"'>
                <![CDATA[ AND ONLINE_MNL_DC LIKE '%'|| #{searchVO.searchKeyword} ||'%' ]]>
            </when>
        </choose>
		</if>
	 	<![CDATA[
		     ORDER BY A.FRST_REGIST_PNTTM DESC
		]]>				
        /* 구현 Sql */
        <![CDATA[
 			 LIMIT #{searchVO.recordPerPage} OFFSET #{searchVO.firstIndex}
        ]]>			
	</select>
	
	<!-- 온라인메뉴얼::목록조회_게시물 총갯수  -->
	<select id="selectOnlineManualListCnt" resultType="int">
        <![CDATA[
			SELECT COUNT(*) totcnt
			  FROM COMTN_ONLINE_MANUAL
			 WHERE 1=1
        ]]>			
	    <if test='searchVO.searchKeyword != null and searchVO.searchKeyword != ""'>
        <choose>
            <when test='searchVO.searchCondition == "ONLINE_MNL_NM"'>
                <![CDATA[ AND ONLINE_MNL_NM LIKE '%'|| #{searchVO.searchKeyword} ||'%' ]]>
            </when>
            <when test='searchVO.searchCondition == "ONLINE_MNL_DFN"'>
                <![CDATA[ AND ONLINE_MNL_DFN LIKE '%'|| #{searchVO.searchKeyword} ||'%' ]]>
            </when>
            <when test='searchVO.searchCondition == "ONLINE_MNL_DC"'>
                <![CDATA[ AND ONLINE_MNL_DC LIKE '%'|| #{searchVO.searchKeyword} ||'%' ]]>
            </when>
        </choose>
		</if>
	</select>

	<!-- 온라인메뉴얼::상세보기 -->
	<select id="selectOnlineManualDetail" resultType="onlineManualVO">
		<![CDATA[
			SELECT A.ONLINE_MNL_ID
			     , A.ONLINE_MNL_NM
			     , A.ONLINE_MNL_SE_CODE
			     , A.ONLINE_MNL_DFN
			     , A.ONLINE_MNL_DC
			     , A.FRST_REGIST_PNTTM			AS "frstRegisterPnttm"
			     , A.FRST_REGISTER_ID
			     , (SELECT USER_NM 
			          FROM COMVN_USER_MASTER 
			         WHERE ESNTL_ID = A.FRST_REGISTER_ID
			       ) 							AS "frstRegisterNm"
			     , A.LAST_UPDT_PNTTM			AS "lastUpdusrPnttm"
			     , A.LAST_UPDUSR_ID
			  FROM COMTN_ONLINE_MANUAL A
			 WHERE A.ONLINE_MNL_ID = #{onlineMnlId}
		]]>
	</select>

	<!-- 온라인메뉴얼::입력  -->
	<insert id="insertOnlineManual">
		<![CDATA[
			INSERT INTO COMTN_ONLINE_MANUAL (
					ONLINE_MNL_ID
				  ,	ONLINE_MNL_NM
				  ,	ONLINE_MNL_SE_CODE
				  ,	ONLINE_MNL_DFN
				  ,	ONLINE_MNL_DC
				  , FRST_REGISTER_ID 
				  , FRST_REGIST_PNTTM 
				  , LAST_UPDUSR_ID
				  , LAST_UPDT_PNTTM 
			) VALUES (
					#{onlineMnlId}
				  ,	#{onlineMnlNm}
				  ,	#{onlineMnlSeCode}
				  ,	#{onlineMnlDfn}
				  ,	#{onlineMnlDc}
				  , #{frstRegisterId}
				  , sysdate()
				  , #{frstRegisterId} 
				  , sysdate()
			)
		]]>
	</insert>

	<!-- 온라인메뉴얼::수정  -->
	<update id="updateOnlineManual">
		<![CDATA[
			UPDATE COMTN_ONLINE_MANUAL
			   SET ONLINE_MNL_NM 		= #{onlineMnlNm}
			     , ONLINE_MNL_SE_CODE 	= #{onlineMnlSeCode}
			     , ONLINE_MNL_DFN 		= #{onlineMnlDfn}
			     , ONLINE_MNL_DC 		= #{onlineMnlDc}
			     , LAST_UPDUSR_ID 		= #{lastUpdusrId}
			     , LAST_UPDT_PNTTM 		= sysdate()
			 WHERE ONLINE_MNL_ID = #{onlineMnlId}
		]]>
	</update>

    <!-- 온라인메뉴얼::삭제  -->
	<delete id="deleteOnlineManual">
		<![CDATA[
			DELETE 
			  FROM COMTN_ONLINE_MANUAL
			 WHERE ONLINE_MNL_ID = #{onlineMnlId}
		]]>
	</delete>

</mapper>