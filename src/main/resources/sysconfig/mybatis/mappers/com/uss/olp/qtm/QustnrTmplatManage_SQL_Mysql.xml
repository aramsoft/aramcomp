<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="aramframework.com.uss.olp.qtm.service.impl.QustnrTmplatManageMapper">

 	<select id="selectQustnrTmplatManageList" resultType="egovMap">
       /* 구현 Sql */
       <![CDATA[
			SELECT A.QUSTNR_TMPLAT_ID		AS "qestnrTmplatId" 
				 , A.QUSTNR_TMPLAT_TY		AS "qestnrTmplatTy" 
				 , A.FRST_REGIST_PNTTM		AS "frstRegisterPnttm" 
				 , (SELECT USER_NM 
				      FROM COMVN_USER_MASTER 
				     WHERE ESNTL_ID = A.FRST_REGISTER_ID
				   ) 						AS "frstRegisterNm" 
				 , A.QUSTNR_TMPLAT_DC		AS "qestnrTmplatCn" 
			  FROM COMTN_QUSTNR_TMPLAT A
		     WHERE 1=1
	 	]]>
  	    <if test='searchKeyword != null and searchKeyword != ""'>
        <choose>
            <when test='searchCondition == "QUSTNR_TMPLAT_DC"'>
               	<![CDATA[ AND A.QUSTNR_TMPLAT_DC LIKE '%'|| #{searchKeyword} ||'%' ]]>
            </when>
            <when test='searchCondition == "QUSTNR_TMPLAT_TY"'>
               	<![CDATA[ AND A.QUSTNR_TMPLAT_TY LIKE '%'|| #{searchKeyword} ||'%' ]]>
            </when>
	    </choose>
		</if>
       	/* 구현 Sql */
        <![CDATA[
 			LIMIT  #{recordPerPage} OFFSET #{firstIndex}
        ]]>			
	</select>

	<select id="selectQustnrTmplatManageListCnt" resultType="int">
        <![CDATA[
			SELECT COUNT(*) totcnt
			  FROM COMTN_QUSTNR_TMPLAT
			 WHERE 1=1
        ]]>			
  	    <if test='searchKeyword != null and searchKeyword != ""'>
        <choose>
            <when test='searchCondition == "QUSTNR_TMPLAT_DC"'>
               	<![CDATA[ AND A.QUSTNR_TMPLAT_DC LIKE '%'|| #{searchKeyword} ||'%' ]]>
            </when>
            <when test='searchCondition == "QUSTNR_TMPLAT_TY"'>
               	<![CDATA[ AND A.QUSTNR_TMPLAT_TY LIKE '%'|| #{searchKeyword} ||'%' ]]>
            </when>
	    </choose>
		</if>
	</select>

	<select id="selectQustnrTmplatManageDetail" resultType="qustnrTmplatManageVO">
        <![CDATA[
			SELECT QUSTNR_TMPLAT_ID		 	AS "qestnrTmplatId"
				 , QUSTNR_TMPLAT_TY		 	AS "qestnrTmplatTy"
				 , FRST_REGIST_PNTTM		AS "frstRegisterPnttm"
				 , FRST_REGISTER_ID			AS "frstRegisterId"
				 , LAST_UPDT_PNTTM			AS "lastUpdusrPnttm"
				 , LAST_UPDUSR_ID			AS "lastUpdusrId"
				 , QUSTNR_TMPLAT_IMAGE_INFO AS "qestnrTmplatImageInfo"
				 , QUSTNR_TMPLAT_DC		    AS "qestnrTmplatCn"
				 , QUSTNR_TMPLAT_PATH_NM	AS "qestnrTmplatCours"
			  FROM COMTN_QUSTNR_TMPLAT
			 WHERE QUSTNR_TMPLAT_ID = #{qestnrTmplatId}
        ]]>			
	</select>

	<select id="selectQustnrTmplatManageTmplatImage" resultType="egovMap">
        <![CDATA[
			SELECT QUSTNR_TMPLAT_IMAGE_INFO 	AS "qestnrTmplatImageInfo"
			  FROM COMTN_QUSTNR_TMPLAT
			 WHERE QUSTNR_TMPLAT_ID = #{qestnrTmplatId}
        ]]>			
	</select>
	
	<insert id="insertQustnrTmplatManage">
	 	<![CDATA[
			INSERT INTO COMTN_QUSTNR_TMPLAT (
					QUSTNR_TMPLAT_ID
				  , QUSTNR_TMPLAT_TY
				  , QUSTNR_TMPLAT_IMAGE_INFO
				  , QUSTNR_TMPLAT_DC
				  , QUSTNR_TMPLAT_PATH_NM
				  , FRST_REGISTER_ID 
				  , FRST_REGIST_PNTTM 
				  , LAST_UPDUSR_ID
				  , LAST_UPDT_PNTTM 
			) VALUES (
					#{qestnrTmplatId}
				  , #{qestnrTmplatTy}
				  , #{qestnrTmplatImageInfo, jdbcType=BLOB}
				  , #{qestnrTmplatCn}
				  , #{qestnrTmplatCours}
				  , #{frstRegisterId}
				  , sysdate()
				  , #{frstRegisterId}
				  , sysdate()
			)
	 	]]>
	</insert>

	<update id="updateQustnrTmplatManage">
        <![CDATA[
			UPDATE COMTN_QUSTNR_TMPLAT
			   SET QUSTNR_TMPLAT_TY = #{qestnrTmplatTy}
				 , QUSTNR_TMPLAT_DC = #{qestnrTmplatCn}
				 , QUSTNR_TMPLAT_PATH_NM = #{qestnrTmplatCours}
   	    		<if test='qestnrTmplatImageInfo" != null' >
				 , QUSTNR_TMPLAT_IMAGE_INFO = #{qestnrTmplatImageInfo, jdbcType=BLOB}
				</if>
				 , LAST_UPDUSR_ID = #{lastUpdusrId}
				 , LAST_UPDT_PNTTM = sysdate()
		     WHERE QUSTNR_TMPLAT_ID = #{qestnrTmplatId}
	 	]]>
	</update>

	<delete id="deleteQustnrTmplatManage">
		<![CDATA[
			DELETE 
			  FROM COMTN_QUSTNR_TMPLAT
			 WHERE QUSTNR_TMPLAT_ID = #{qestnrTmplatId}
		]]>
	</delete>

</mapper>