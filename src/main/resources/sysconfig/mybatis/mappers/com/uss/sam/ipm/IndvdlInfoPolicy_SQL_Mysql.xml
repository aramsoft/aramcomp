<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="aramframework.com.uss.sam.ipm.dao.IndvdlInfoPolicyMapper">

	<!-- 개인정보보호정책확인::목록조회 게시물정보 -->
	<select id="selectIndvdlInfoPolicyList" resultType="egovMap">
        /* 구현 Sql */
       	<![CDATA[
			SELECT A.INDVDL_INFO_POLICY_ID	AS "indvdlInfoId"
			     , A.INDVDL_INFO_POLICY_NM	AS "indvdlInfoNm"
			     , A.INDVDL_INFO_POLICY_AGRE_AT	AS "indvdlInfoYn"
			     , (SELECT USER_NM 
			          FROM COMVN_USER_MASTER 
			         WHERE ESNTL_ID = A.FRST_REGISTER_ID
			       ) 						AS "frstRegisterNm" 
			     , A.FRST_REGIST_PNTTM		AS "frstRegisterPnttm" 
			  FROM COMTN_INDVDL_INFO_POLICY A
			 WHERE 1=1
	 	]]>
     	<if test='searchVO.searchKeyword != null and searchVO.searchKeyword != ""'>
        <choose>
            <when test='searchVO.searchCondition == "INDVDL_INFO_POLICY_NM"'>
                <![CDATA[ AND INDVDL_INFO_POLICY_NM  LIKE '%'|| #{searchVO.searchKeyword} ||'%' ]]>
            </when>
            <when test='searchVO.searchCondition == "INDVDL_INFO_POLICY_CN"'>
                <![CDATA[ AND INDVDL_INFO_POLICY_CN  LIKE '%'|| #{searchVO.searchKeyword} ||'%' ]]>
            </when>
        </choose>
		</if>
	 	<![CDATA[
			 ORDER BY A.FRST_REGIST_PNTTM DESC
		]]>				
        /* 구현 Sql */
        <![CDATA[
 			LIMIT  #{searchVO.recordPerPage} OFFSET #{searchVO.firstIndex}
        ]]>			
	</select>

	<!-- 개인정보보호정책확인::목록조회_게시물 총갯수  -->
	<select id="selectIndvdlInfoPolicyListCnt" resultType="int">
       	<![CDATA[
			SELECT COUNT(*) totcnt
			  FROM COMTN_INDVDL_INFO_POLICY
			 WHERE 1=1
        ]]>			
     	<if test='searchVO.searchKeyword != null and searchVO.searchKeyword != ""'>
        <choose>
            <when test='searchVO.searchCondition == "INDVDL_INFO_POLICY_NM"'>
                <![CDATA[ AND INDVDL_INFO_POLICY_NM  LIKE '%'|| #{searchVO.searchKeyword} ||'%' ]]>
            </when>
            <when test='searchVO.searchCondition == "INDVDL_INFO_POLICY_CN"'>
                <![CDATA[ AND INDVDL_INFO_POLICY_CN  LIKE '%'|| #{searchVO.searchKeyword} ||'%' ]]>
            </when>
        </choose>
		</if>
	</select>
	
	<!-- 개인정보보호정책확인::상세보기 -->
	<select id="selectIndvdlInfoPolicyDetail" resultType="indvdlInfoPolicyVO">
	 	<![CDATA[
			SELECT A.INDVDL_INFO_POLICY_ID			AS "indvdlInfoId"
			     , A.INDVDL_INFO_POLICY_NM			AS "indvdlInfoNm"
			     , A.INDVDL_INFO_POLICY_CN			AS "indvdlInfoDc"
			     , A.INDVDL_INFO_POLICY_AGRE_AT		AS "indvdlInfoYn"
			     , A.FRST_REGIST_PNTTM				AS "frstRegisterPnttm"
			     , A.FRST_REGISTER_ID				AS "frstRegisterId"
			     , A.LAST_UPDT_PNTTM				AS "lastUpdusrPnttm"
			     , A.LAST_UPDUSR_ID  				AS "lastUpdusrId"
			  FROM COMTN_INDVDL_INFO_POLICY A
			 WHERE 1=1
			   AND A.INDVDL_INFO_POLICY_ID = #{indvdlInfoId}
	 	]]>
	</select>

	<!-- 개인정보보호정책확인::입력  -->
	<insert id="insertIndvdlInfoPolicy">	     
	 	<![CDATA[
			INSERT INTO COMTN_INDVDL_INFO_POLICY ( 
					INDVDL_INFO_POLICY_ID
				  ,	INDVDL_INFO_POLICY_NM
				  ,	INDVDL_INFO_POLICY_CN
				  ,	INDVDL_INFO_POLICY_AGRE_AT
				  , FRST_REGISTER_ID 
				  , FRST_REGIST_PNTTM 
				  , LAST_UPDUSR_ID
				  , LAST_UPDT_PNTTM 
			)VALUES( 
					#{indvdlInfoId}
				  ,	#{indvdlInfoNm}
				  ,	#{indvdlInfoDc}
				  ,	#{indvdlInfoYn}
				  , #{frstRegisterId}
				  , sysdate()
				  , #{frstRegisterId} 
				  , sysdate()
			)
	 	]]>
	</insert>
	
	<!-- 개인정보보호정책확인::수정  -->
	<update id="updateIndvdlInfoPolicy">
		<![CDATA[
			UPDATE COMTN_INDVDL_INFO_POLICY 
			   SET INDVDL_INFO_POLICY_NM 		= #{indvdlInfoNm}
			     , INDVDL_INFO_POLICY_CN 		= #{indvdlInfoDc}
			     , INDVDL_INFO_POLICY_AGRE_AT 	= #{indvdlInfoYn}
			     , LAST_UPDUSR_ID 				= #{lastUpdusrId}
			     , LAST_UPDT_PNTTM 				= sysdate()
			 WHERE INDVDL_INFO_POLICY_ID = #{indvdlInfoId}
		]]>
	</update>
	
    <!-- 개인정보보호정책확인::삭제  -->
	<delete id="deleteIndvdlInfoPolicy">
		<![CDATA[
			DELETE 
			  FROM COMTN_INDVDL_INFO_POLICY 
			 WHERE INDVDL_INFO_POLICY_ID = #{indvdlInfoId}
		]]>
	</delete>

</mapper>