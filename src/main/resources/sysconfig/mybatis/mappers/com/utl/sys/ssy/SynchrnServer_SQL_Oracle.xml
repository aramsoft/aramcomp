<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="aramframework.com.utl.sys.ssy.service.impl.SynchrnServerMapper">

    <select id="selectSynchrnServerList" resultType="egovMap">
		<![CDATA[
            SELECT *
              FROM (
            SELECT ROWNUM RNUM, ALL_LIST.*
              FROM (
        ]]>
        /* 구현 Sql */
       	<![CDATA[
            SELECT SERVER_ID
                 , SERVER_NM
                 , SERVER_IP
                 , SERVER_PORT
                 , FTP_ID
                 , FTP_PASSWORD
                 , SYNCHRN_LC
                 , REFLCT_AT
                 , FRST_REGIST_PNTTM
                 , FRST_REGISTER_ID
                 , LAST_UPDT_PNTTM
                 , LAST_UPDUSR_ID
              FROM COMTN_SYNCHRN_SERVER_INFO
             WHERE 1 = 1
       	]]>                
       	<if test='strSynchrnServerNm != null and strSynchrnServerNm != ""'>
                <![CDATA[ AND SERVER_NM LIKE '%'|| #{strSynchrnServerNm} ||'%' ]]>
		</if>
       	<![CDATA[                
             ORDER BY SERVER_ID DESC
		]]>				
        /* 구현 Sql */
        <![CDATA[
                   ) ALL_LIST
                   )
             WHERE RNUM BETWEEN #{firstIndex} + 1 AND #{firstIndex} + #{recordPerPage}
        ]]>			
    </select>

    <select id="selectSynchrnServerListCnt" resultType="int">
       	<![CDATA[
            SELECT COUNT(*) totcnt
              FROM COMTN_SYNCHRN_SERVER_INFO
             WHERE 1 = 1
       	]]>                
       	<if test='strSynchrnServerNm != null and strSynchrnServerNm != ""'>
                <![CDATA[ AND SERVER_NM LIKE '%'|| #{strSynchrnServerNm} ||'%' ]]>
		</if>
    </select>

    <select id="selectSynchrnServer" resultType="synchrnServerVO">
        <![CDATA[
            SELECT SERVER_ID
                 , SERVER_NM
                 , SERVER_IP
                 , SERVER_PORT
                 , FTP_ID
                 , FTP_PASSWORD
                 , SYNCHRN_LC
                 , REFLCT_AT
                 , FRST_REGIST_PNTTM
                 , FRST_REGISTER_ID
                 , LAST_UPDT_PNTTM
                 , LAST_UPDUSR_ID
              FROM COMTN_SYNCHRN_SERVER_INFO
             WHERE 1 = 1
               AND SERVER_ID = #{serverId}   
        ]]>
    </select>

    <insert id="insertSynchrnServer" >
        <![CDATA[
             INSERT INTO COMTN_SYNCHRN_SERVER_INFO (
             		SERVER_ID
             	  , SERVER_NM
             	  , SERVER_IP
             	  , SERVER_PORT
             	  , FTP_ID
             	  , FTP_PASSWORD
             	  , SYNCHRN_LC
             	  , REFLCT_AT
				  , FRST_REGISTER_ID 
				  , FRST_REGIST_PNTTM 
				  , LAST_UPDUSR_ID
				  , LAST_UPDT_PNTTM 
             ) VALUES (
             		#{serverId}
             	  , #{serverNm}
             	  , #{serverIp}
             	  , #{serverPort}
             	  , #{ftpId}
             	  , #{ftpPassword}
             	  , #{synchrnLc}
             	  , #{reflctAt}
				  , #{frstRegisterId}
				  , SYSDATE
				  , #{frstRegisterId} 
				  , SYSDATE
             )
        ]]>
    </insert>

    <update id="updateSynchrnServer" >
        <![CDATA[
            UPDATE COMTN_SYNCHRN_SERVER_INFO
               SET SERVER_NM = #{serverNm}
                 , SERVER_IP = #{serverIp}
                 , SERVER_PORT = #{serverPort}
                 , FTP_ID = #{ftpId}
                 , FTP_PASSWORD = #{ftpPassword}
                 , SYNCHRN_LC = #{synchrnLc}
                 , LAST_UPDUSR_ID = #{lastUpdusrId}
                 , LAST_UPDT_PNTTM = SYSDATE
             WHERE SERVER_ID = #{serverId}
        ]]>
    </update>    

    <delete id="deleteSynchrnServer" >
        <![CDATA[
            DELETE 
              FROM COMTN_SYNCHRN_SERVER_INFO
             WHERE SERVER_ID = #{serverId}
        ]]>
    </delete>  

    <update id="processSynchrn" >
        <![CDATA[
            UPDATE COMTN_SYNCHRN_SERVER_INFO
               SET REFLCT_AT = #{reflctAt}
             WHERE SERVER_ID = #{serverId}
        ]]>
    </update>

    <select id="processSynchrnServerList" resultType="egovMap">
        <![CDATA[
            SELECT SERVER_ID
            	 , SERVER_NM
            	 , SERVER_IP
            	 , SERVER_PORT
            	 , FTP_ID
            	 , FTP_PASSWORD
            	 , SYNCHRN_LC
            	 , REFLCT_AT
            	 , FRST_REGIST_PNTTM
            	 , FRST_REGISTER_ID
            	 , LAST_UPDT_PNTTM
            	 , LAST_UPDUSR_ID
              FROM COMTN_SYNCHRN_SERVER_INFO
             WHERE 1 = 1
        ]]>
       	<if test='reflctAt != null and reflctAt != ""'>
                <![CDATA[ AND REFLCT_AT LIKE '%'|| #{reflctAt} ||'%' ]]>
		</if>
    </select>  
      
</mapper>