<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="aramframework.mbl.com.geo.dao.GeoLocationMapper">

	<select id="selectBuildingLocationInfoList" resultType="geoLocationVO" >
		<![CDATA[
            SELECT *
              FROM (
            SELECT ROWNUM RNUM, ALL_LIST.*
              FROM (
        ]]>
        /* 구현 Sql */
       	<![CDATA[
			SELECT SN
			     , BULD_NM
			     , LA
			     , LO
			     , TELNO
			     , ADRES
			  FROM MBLTN_GEO_LOCATION
			 WHERE 1 = 1
		]]>
   	    <if test='searchVO.searchKeyword != null and searchVO.searchKeyword != ""'>
        <choose>
            <when test='searchVO.searchCondition == "BULD_NM"'>
             	<![CDATA[ AND BULD_NM LIKE '%'|| #{searchVO.searchKeyword} ||'%' ]]>
            </when>
            <when test='searchVO.searchCondition == "TELNO"'>
             	<![CDATA[ AND TELNO LIKE '%'|| #{searchVO.searchKeyword} ||'%' ]]>
            </when>
            <when test='searchVO.searchCondition == "ADRES"'>
             	<![CDATA[ AND ADRES LIKE '%'|| #{searchVO.searchKeyword} ||'%' ]]>
            </when>
        </choose>
		</if>
		<![CDATA[
			ORDER BY sn DESC
		]]>				
        /* 구현 Sql */
        <![CDATA[
                   ) ALL_LIST
                   )
             WHERE RNUM BETWEEN #{searchVO.firstIndex} + 1 AND #{searchVO.firstIndex} + #{searchVO.recordPerPage}
        ]]>
			
	</select>	
	
	<select id="selectBuildingLocationInfoListCnt" resultType="int" >
		<![CDATA[
			SELECT COUNT(SN)
			  FROM MBLTN_GEO_LOCATION
			 WHERE 1 = 1
		]]>
   	    <if test='searchVO.searchKeyword != null and searchVO.searchKeyword != ""'>
        <choose>
            <when test='searchVO.searchCondition == "BULD_NM"'>
             	<![CDATA[ AND BULD_NM LIKE '%'|| #{searchVO.searchKeyword} ||'%' ]]>
            </when>
            <when test='searchVO.searchCondition == "TELNO"'>
             	<![CDATA[ AND TELNO LIKE '%'|| #{searchVO.searchKeyword} ||'%' ]]>
            </when>
            <when test='searchVO.searchCondition == "ADRES"'>
             	<![CDATA[ AND ADRES LIKE '%'|| #{searchVO.searchKeyword} ||'%' ]]>
            </when>
        </choose>
		</if>
	</select>	
 
 	<select id="selectBuildingLocationInfo" resultType="geoLocationVO" >
		<![CDATA[
			SELECT SN
			     , MBER_ID
			     , BULD_NM
			     , LA
			     , LO
			     , TELNO
			     , ADRES
			  FROM MBLTN_GEO_LOCATION
			 WHERE SN = #{sn}
		]]>	
	</select>
 
 	<insert id="insertBuildingLocationInfo"  >
		<![CDATA[
			INSERT INTO MBLTN_GEO_LOCATION (
					SN
				  , MBER_ID
				  , BULD_NM
				  , LA
				  , LO
				  , TELNO
				  , ADRES
			) VALUES (
					#{sn}
				  , #{mberId}
				  , #{buldNm}
				  , #{la}
				  , #{lo}
				  , #{telno}
				  , #{adres}
			)			
		]]>
	</insert>
	
	<update id="updateBuildingLocationInfo">
		<![CDATA[
			UPDATE MBLTN_GEO_LOCATION
			   SET BULD_NM = #{buldNm}
			     , LA 	   = #{la}
			     , LO 	   = #{lo}
			     , TELNO   = #{telno}
			     , ADRES   = #{adres}
 			 WHERE SN = #{sn}
		]]>
    	<if test='mberId != null and mberId != ""'>
 				<![CDATA[ AND MBER_ID = #{mberId} ]]>
		</if>
	</update>
	
	<delete id="deleteBuildingLocationInfo">
		<![CDATA[
			DELETE 
			  FROM MBLTN_GEO_LOCATION 
			 WHERE SN = #{sn}
		]]>
     	<if test='mberId != null and mberId != ""'>
 				<![CDATA[ AND MBER_ID = #{mberId} ]]>
		</if>
	</delete>
	
</mapper>